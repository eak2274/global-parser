-- ==========================================================
-- СКРИПТ ДЛЯ УДАЛЕНИЯ ВСЕХ ТАБЛИЦ ИЗ СХЕМЫ 'public'
-- ОПАСНО: Удаляет ВСЕ таблицы и данные в схеме 'public'
-- ==========================================================

DO $$ DECLARE
    r RECORD;
BEGIN
    -- Итерируемся по всем таблицам в схеме 'public'
    FOR r IN (
        SELECT tablename
        FROM pg_tables
        WHERE schemaname = 'public'
    ) LOOP
        -- Динамически формируем и выполняем команду DROP TABLE для каждой таблицы
        -- %I безопасно форматирует имя таблицы
        -- CASCADE удаляет все зависимые объекты (внешние ключи и т.д.)
        EXECUTE format('DROP TABLE IF EXISTS public.%I CASCADE', r.tablename);
        RAISE NOTICE 'Таблица %.% была удалена.', 'public', r.tablename;
    END LOOP;
END $$;

-- ==========================================================
-- ГОТОВО! Все таблицы в схеме 'public' удалены.
-- ==========================================================
